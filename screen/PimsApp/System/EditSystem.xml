<screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-2.0.xsd"
        default-menu-title="System" default-menu-index="1">

    <parameter name="assetId"/>

    <transition name="UpdateSystem">
        <actions>
            <service-call name="update#Asset" in-map="context"/>

            <service-call name="delete#mantle.work.effort.WorkEffortAssetAssign" in-map="context"/>

            <set field="context.workEffortId" from="newWorkEffortId"/>
            <service-call name="create#WorkEffortAssetAssign" in-map="context"/>
            <message>Update System successfully!</message>
        </actions>
        <default-response url="."/>
    </transition>

    <actions>
        <entity-find-one entity-name="WorkEffortAssetAndAssign" value-field="asset"/>
    </actions>
    <widgets>
        <section name="ProjectMenu" condition="project">
            <widgets>
                 <link url="newProject" text="New Project" link-type="hidden-form" icon="glyphicon glyphicon-plus"/>
            </widgets>
        </section>

        <section name="Update">
            <condition>
                <compare field="assetId" operator="not-empty"/>
            </condition>
            <widgets>
                <form-single name="EditAsset" transition="UpdateSystem" map="asset">
                    <field name="assetId">
                        <default-field title="Asset Id">
                            <hidden/>
                        </default-field>
                    </field>
                    <field name="workEffortId">
                        <default-field>
                            <hidden/>
                        </default-field>
                    </field>
                    <field name="fromDate">
                        <default-field>
                            <hidden/>
                        </default-field>
                    </field>
                    <field name="assetName">
                        <default-field title="System Name">
                            <text-line/>
                        </default-field>
                    </field>
                    <field name="newWorkEffortId">
                        <default-field title="Project">
                            <widget-template-include location="component://pims/template/screen/PimsWidgetTemplates.xml#PimsProjectDropDown">
                                <set field="noCurrentSelectedKey" value="${workEffortId}"/>
                            </widget-template-include>
                        </default-field>
                    </field>
                    <field name="comments">
                        <default-field title="comments">
                            <text-area/>
                        </default-field>
                    </field>
                    <field name="submitButton">
                        <default-field title="Update">
                            <submit/>
                        </default-field>
                    </field>
                </form-single>
            </widgets>
        </section>
    </widgets>
</screen>